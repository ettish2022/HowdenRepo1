<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>53.0</apiVersion>
    <assignments>
        <name>Add_Current_Income_Insurance_Bank_to_Var</name>
        <label>Add Current Income Insurance Bank to Var</label>
        <locationX>314</locationX>
        <locationY>1919</locationY>
        <assignmentItems>
            <assignToReference>var_Sum_Sub_Policies</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>$Record.Insurance_Bank__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_Main_Sub_Difference</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Add_Insurance_Bank_to_var</name>
        <label>Add Insurance Bank to var</label>
        <locationX>402</locationX>
        <locationY>1703</locationY>
        <assignmentItems>
            <assignToReference>var_Sum_Sub_Policies</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>Sub_Policies_Loop.Insurance_Bank__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Sub_Policies_Loop</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Bellow_Zero_to_Main_Policy</name>
        <label>Assign Bellow Zero to Main Policy</label>
        <locationX>314</locationX>
        <locationY>2399</locationY>
        <assignmentItems>
            <assignToReference>Get_Main_Policy.Bellow_Zero_Policy__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Main_Policy</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_to_Col</name>
        <label>Assign to Col</label>
        <locationX>446</locationX>
        <locationY>1367</locationY>
        <assignmentItems>
            <assignToReference>col_Sub_Policies</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Sub_Policies_0</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Sub_Policies_Loop</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_to_Col_0</name>
        <label>Assign to Col</label>
        <locationX>182</locationX>
        <locationY>1367</locationY>
        <assignmentItems>
            <assignToReference>col_Sub_Policies</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Sub_Policies</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Sub_Policies_Loop</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Var</name>
        <label>Assign Var</label>
        <locationX>50</locationX>
        <locationY>2159</locationY>
        <assignmentItems>
            <assignToReference>var_Main_Sub_Difference</assignToReference>
            <operator>Assign</operator>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Set_Income_s_values</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Var_0</name>
        <label>Assign Var</label>
        <locationX>314</locationX>
        <locationY>2159</locationY>
        <assignmentItems>
            <assignToReference>var_Main_Sub_Difference</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_ABS_Main_Sub_Difference</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Main_Policy</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Income_s_values</name>
        <label>Set Income&apos;s values</label>
        <locationX>534</locationX>
        <locationY>2831</locationY>
        <assignmentItems>
            <assignToReference>$Record.Novidea_HPC__Agency_Fee__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_AgencyFee</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Novidea_HPC__Fees__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_Fees</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Novidea_HPC__Premium__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_NetPremium</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Update_Income</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Need_to_Update_Policy</name>
        <label>Set Need to Update Policy</label>
        <locationX>710</locationX>
        <locationY>575</locationY>
        <assignmentItems>
            <assignToReference>var_NeedUpdatePolicy</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_if_Bellow_Zero</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Set_Values_from_Policy</name>
        <label>Set Values from Policy</label>
        <locationX>182</locationX>
        <locationY>695</locationY>
        <assignmentItems>
            <assignToReference>$Record.Agency_Fee_Percentage__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Policies_Values.Agency_Fee_Percentage__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Fee_Percentage__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Policies_Values.Fee_Percentage__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Insurance_Bank__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Policies_Values.Insurance_Bank__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Tariff__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Policies_Values.Tariff__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>var_NeedUpdatePolicy</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Novidea_HPC__Commission_Percentage__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Policies_Values.Novidea_HPC__Commission__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Check_if_Bellow_Zero</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Check_Endorsement_Number</name>
        <label>Check Endorsement Number</label>
        <locationX>842</locationX>
        <locationY>455</locationY>
        <defaultConnector>
            <targetReference>Check_if_Bellow_Zero</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Income_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Main_Policy1__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Endorsement_Number__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Need_to_Update_Policy</targetReference>
            </connector>
            <label>Income 0 for Parent Policy</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_Bellow_Zero</name>
        <label>Check if Bellow Zero</label>
        <locationX>534</locationX>
        <locationY>1007</locationY>
        <defaultConnector>
            <targetReference>Set_Income_s_values</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Not_Bellow_Zero</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Main_Policy1__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Main_Policy1__r.Bellow_Zero_Policy__c</leftValueReference>
                <operator>NotEqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Novidea_HPC__Product_Def_Name__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>קבלנים בת</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_if_First_Income_on_Policy</targetReference>
            </connector>
            <label>Not Bellow Zero</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_if_First_Income_on_Policy</name>
        <label>Check if First Income on Policy</label>
        <locationX>314</locationX>
        <locationY>1127</locationY>
        <defaultConnector>
            <targetReference>Get_Sub_Policies_0</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>First_Income</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.New_Income_Record__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Sub_Policies</targetReference>
            </connector>
            <label>First Income</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Main_Sub_Difference</name>
        <label>Check Main Sub Difference</label>
        <locationX>314</locationX>
        <locationY>2039</locationY>
        <defaultConnector>
            <targetReference>Set_Income_s_values</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Difference_Greater_Than_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>f_Main_Sub_Difference</leftValueReference>
                <operator>GreaterThan</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Var</targetReference>
            </connector>
            <label>Difference Greater Than 0</label>
        </rules>
        <rules>
            <name>Difference_Less_Than_0</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>f_Main_Sub_Difference</leftValueReference>
                <operator>LessThanOrEqualTo</operator>
                <rightValue>
                    <numberValue>0.0</numberValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Var_0</targetReference>
            </connector>
            <label>Difference Less Than 0</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_Policy_s_fields</name>
        <label>Check Policy&apos;s % fields</label>
        <locationX>314</locationX>
        <locationY>575</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Not_Null</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Policies_Values.Insurance_Bank__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Policies_Values.Agency_Fee_Percentage__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>Get_Policies_Values.Fee_Percentage__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Set_Values_from_Policy</targetReference>
            </connector>
            <label>Not Null</label>
        </rules>
    </decisions>
    <decisions>
        <name>Check_update_for_Kablanim</name>
        <label>Check update for Kablanim</label>
        <locationX>534</locationX>
        <locationY>335</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Kablanim_updated</name>
            <conditionLogic>(1 OR 2 OR 3 OR 6 OR 7) AND (4 OR 5)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Insurance_Bank__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Tariff__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Agency_Fee_Percentage__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Novidea_HPC__Product_Definition__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>קבלנים בת</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Novidea_HPC__Product_Definition__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>קבלנים הצהרתית</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Fee_Percentage__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Commission_Percentage__c</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Check_Endorsement_Number</targetReference>
            </connector>
            <label>Kablanim updated</label>
        </rules>
        <rules>
            <name>New_and_fields_are_null</name>
            <conditionLogic>1 AND (5 OR 6) AND (2 OR 3 OR 4 OR 7)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.New_Income_Record__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Insurance_Bank__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Agency_Fee_Percentage__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Fee_Percentage__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Novidea_HPC__Product_Definition__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>קבלנים בת</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Novidea_HPC__Product_Definition__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>קבלנים הצהרתית</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Tariff__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Policies_Values</targetReference>
            </connector>
            <label>New and % fields are null</label>
        </rules>
        <rules>
            <name>New_and_fields_are_not_NULL</name>
            <conditionLogic>1 AND 2 AND 3 AND (4 OR 5)</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Insurance_Bank__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Agency_Fee_Percentage__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Fee_Percentage__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Novidea_HPC__Product_Definition__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>קבלנים בת</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Novidea_HPC__Policy__r.Novidea_HPC__Product_Definition__r.Name</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>קבלנים הצהרתית</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Check_Endorsement_Number</targetReference>
            </connector>
            <label>New and % fields are not NULL</label>
        </rules>
    </decisions>
    <description>HIL-35, HIL-100</description>
    <environments>Default</environments>
    <formulas>
        <name>f_ABS_Main_Sub_Difference</name>
        <dataType>Number</dataType>
        <expression>ABS({!f_Main_Sub_Difference})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>f_AgencyFee</name>
        <dataType>Number</dataType>
        <expression>({!$Record.Agency_Fee_Percentage__c}*((IF(ISBLANK({!var_Main_Sub_Difference}), {!$Record.Insurance_Bank__c}, {!var_Main_Sub_Difference}))*{!$Record.Tariff__c}*(1 + {!$Record.Fee_Percentage__c})))+({!$Record.Neto_Extra_Extension__c}*{!$Record.Extension_Agency_Fee_Percentage__c})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>f_Fees</name>
        <dataType>Number</dataType>
        <expression>({!$Record.Fee_Percentage__c} * (IF(ISBLANK({!var_Main_Sub_Difference}), {!$Record.Insurance_Bank__c}, {!var_Main_Sub_Difference})) * {!$Record.Tariff__c})+({!$Record.Neto_Extra_Extension__c}*{!$Record.Extension_Fee_Percentage__c})</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>f_IsNew</name>
        <dataType>Boolean</dataType>
        <expression>ISNEW()</expression>
    </formulas>
    <formulas>
        <name>f_Main_Sub_Difference</name>
        <dataType>Number</dataType>
        <expression>{!$Record.Novidea_HPC__Policy__r.Main_Policy1__r.Insurance_Bank__c}-{!var_Sum_Sub_Policies}</expression>
        <scale>2</scale>
    </formulas>
    <formulas>
        <name>f_NetPremium</name>
        <dataType>Number</dataType>
        <expression>((IF(ISBLANK({!var_Main_Sub_Difference}), {!$Record.Insurance_Bank__c}, {!var_Main_Sub_Difference})) * {!$Record.Tariff__c})+{!$Record.Neto_Extra_Extension__c}</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>Income Created or Updated {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Income Created or Updated</label>
    <loops>
        <name>Sub_Policies_Loop</name>
        <label>Sub Policies Loop</label>
        <locationX>314</locationX>
        <locationY>1583</locationY>
        <collectionReference>col_Sub_Policies</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Add_Insurance_Bank_to_var</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Add_Current_Income_Insurance_Bank_to_Var</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Main_Policy</name>
        <label>Get Main Policy</label>
        <locationX>314</locationX>
        <locationY>2279</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Bellow_Zero_to_Main_Policy</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Novidea_HPC__Policy__r.Main_Policy1__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Novidea_HPC__Policy__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Policies_Values</name>
        <label>Get Policies Values</label>
        <locationX>314</locationX>
        <locationY>455</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_Policy_s_fields</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Novidea_HPC__Policy__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Novidea_HPC__Policy__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Policy</name>
        <label>Get Policy</label>
        <locationX>534</locationX>
        <locationY>3191</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Novidea_HPC__Policy__c</elementReference>
            </value>
        </filters>
        <object>Novidea_HPC__Policy__c</object>
        <outputAssignments>
            <assignToReference>so_Policy.Novidea_HPC__Agency_Fee__c</assignToReference>
            <field>Novidea_HPC__Fees__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>so_Policy.Novidea_HPC__Premium_Amount__c</assignToReference>
            <field>Novidea_HPC__Premium_Amount__c</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Sub_Policies</name>
        <label>Get Sub Policies</label>
        <locationX>182</locationX>
        <locationY>1247</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_to_Col_0</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Main_Policy1__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Novidea_HPC__Policy__r.Main_Policy1__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>$Record.Novidea_HPC__Policy__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Novidea_HPC__Policy__c</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Insurance_Bank__c</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Sub_Policies_0</name>
        <label>Get Sub Policies</label>
        <locationX>446</locationX>
        <locationY>1247</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_to_Col</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Main_Policy1__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Novidea_HPC__Policy__r.Main_Policy1__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Novidea_HPC__Policy__c</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Insurance_Bank__c</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Income</name>
        <label>Update Income</label>
        <locationX>534</locationX>
        <locationY>2951</locationY>
        <connector>
            <targetReference>Call_Update_Policy</targetReference>
        </connector>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <recordUpdates>
        <name>Update_Main_Policy</name>
        <label>Update Main Policy</label>
        <locationX>314</locationX>
        <locationY>2519</locationY>
        <connector>
            <targetReference>Set_Income_s_values</targetReference>
        </connector>
        <inputReference>Get_Main_Policy</inputReference>
    </recordUpdates>
    <start>
        <locationX>408</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Check_update_for_Kablanim</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Novidea_HPC__Endorsement_Number__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <numberValue>-101.0</numberValue>
            </value>
        </filters>
        <filters>
            <field>Novidea_HPC__Endorsement_Number__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <numberValue>-201.0</numberValue>
            </value>
        </filters>
        <object>Novidea_HPC__Income__c</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Active</status>
    <subflows>
        <name>Call_Update_Policy</name>
        <label>Call  Update Policy</label>
        <locationX>534</locationX>
        <locationY>3071</locationY>
        <connector>
            <targetReference>Get_Policy</targetReference>
        </connector>
        <flowName>Update_Policy_Roll_Up_Sum</flowName>
        <inputAssignments>
            <name>var_IncomeId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>var_NeedUpdatePolicy</name>
            <value>
                <elementReference>var_NeedUpdatePolicy</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <name>var_PolicyId</name>
            <value>
                <elementReference>$Record.Novidea_HPC__Policy__c</elementReference>
            </value>
        </inputAssignments>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </subflows>
    <variables>
        <name>col_Sub_Policies</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Novidea_HPC__Policy__c</objectType>
    </variables>
    <variables>
        <name>so_Policy</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Novidea_HPC__Policy__c</objectType>
    </variables>
    <variables>
        <name>var_Main_Sub_Difference</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
    <variables>
        <name>var_NeedUpdatePolicy</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>var_Sum_Sub_Policies</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
    </variables>
</Flow>
